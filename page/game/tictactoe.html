<!DOCTYPE html>

<html>

	<head>
		<title> Game </title>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
		<style>

			#grid {
				display: grid;
				/*grid-template-columns: repeat(3, auto); */
				text-align: center;
				grid-template-columns: 1fr 1fr 1fr;
				grid-template-rows: 1fr 1fr 1fr;
				gap: 1vw;

			}

			.cell {
				text-align: center;
				width: 30vw;
				height: 30vw;
				border: 1px solid black;
				cursor: pointer;
				font-size: 60px;
				margin: 0;
				padding: 0;
			}
			
		</style>
	</head>

	<body>

		<script> 

			let myturn, x, y; // vars

			
			// init //
			let ws, room; window._init = (a, b) => { ws = a; room = b; console.log("Game initialized"); _start(); };
			function _start() {

				myturn = false;
				x      = "O";
				y      = "X";     
				
			}
			function _restart() {
				
				for (let id = 0; id < 9; ++id) {
					let cell = document.getElementById(id);
					cell.innerHTML = "";
					cell.onclick = press;
				}


				_start();
			}  
			// init //

			function setcell(id, a) {

				let cell = document.getElementById(id);
				cell.onclick = undefined;
				cell.innerHTML = a;
				
			}

			function press(id) {
				if (!myturn) { return }
				id = id.srcElement ? id.srcElement.id : id;
				ws.send(JSON.stringify({
					type: "gamepress",
					id  : id
				}));
				setcell(id, x);
				myturn = false;
			}

			function msgevent(msg) { // already decoded json btw
				console.log(msg);

				switch (msg.type) {

					case "gamestart":
						let t = x;
						x = y;
						y = t;
						myturn = true;
						break;

					case "gamepress":
						console.log("PRESSED")
						setcell(msg.id, y);
						myturn = true;
						break;

					default:
						break;

						
				}

				
			}

		</script>

		<p> hi </p>

		<div id="grid">
            <div id="0" onclick="press(0)" class="cell"></div>
            <div id="1" onclick="press(1)" class="cell"></div>
            <div id="2" onclick="press(2)" class="cell"></div>
            <div id="3" onclick="press(3)" class="cell"></div>
            <div id="4" onclick="press(4)" class="cell"></div>
            <div id="5" onclick="press(5)" class="cell"></div>
            <div id="6" onclick="press(6)" class="cell"></div>
            <div id="7" onclick="press(7)" class="cell"></div> 
            <div id="8" onclick="press(8)" class="cell"></div>
        </div>
		
	</body> 
